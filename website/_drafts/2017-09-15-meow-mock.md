---
layout: post
title: ""
date: "2017-09-15"
abstract: ""
keywords: ["mock", "node"]
thumb: ""
---

[源码](https://github.com/sunmengyuan/note/tree/master/node/mock)

启动方式：

```bash
cd meow-mock
npm install
npm run start
```

默认端口号 8888，可在 /bin/www 文件中修改：

```js
var port = normalizePort(process.env.PORT || '8888');
```

*****

### 使用方法

非常非常非常小白级！

首先在 /data 文件夹内创建 .js 文件，命名随意，例如 example.js。然后打开 route.js 添加如下代码：

```js
var example = require('./data/example');
var requestGatherLst = [
    example
];
```

你可以理解为在该服务中注册了刚刚创建的接口文件。我们可以创建多个接口文件 module1.js、module2.jd、module3.js... 

下面讲解如何编写接口文件：

```js
var type = require('../type');
module.exports = {
    example1: {
        url: '/example1/_data',
        type: 'GET',
        data: function () {
            return {}
        }
    },
    example2: {
        url: '/example2/_data',
        type: 'POST',
        data: function () {
            return {}
        }
    }
}
```

需要定义每一接口的 __url__ 及 __type__，返回数据的讲究在于 data 回调函数的返回值。

*****

举个板栗：

```js
example1: {
    url: '/example1/_data',
    type: 'GET',
    data: function () {
        return {
            message: '请求成功',
            error: 0,
            data: {
                id: type.id(), // 返回 id
                number: type.number({ // 返回数值
                    min: 288,
                    max: 999
                }),
                bool: type.bool(), // 返回布尔值
                string1: type.string([ // 返回字符串
                    '文案一',
                    '文案二',
                    '文案三'
                ]),
                string2: type.string({ // 返回字符串
                    minL: 5,
                    maxL: 16
                }),
                image1: type.image([ // 返回图片链接
                    'http://oij8a9ql4.bkt.clouddn.com/default-fe.jpg',
                    'http://osm0bpix4.bkt.clouddn.com/thumb.jpg'
                ]),
                image2: type.image({ // 返回图片链接
                    type: '-thumb'
                }),
                list1: type.list({ // 返回列表
                    length: 5,
                    data: function () {
                        return type.number()
                    }
                }),
                list2: type.list({ // 返回列表
                    length: 22,
                    index: {
                        name: 'idx',
                        format: '0\d'
                    },
                    data: function () {
                        return {
                            pro1: type.number(),
                            pro2: type.string()
                        }
                    }
                })
            }
        }
    }
}
```

+ __id__ 使用时间戳作为其值。

+ __number__ 可使用 min、max 配置项规定其数值范围，默认范围 1 ~ 11。

+ __bool__ 随机返回 true 或 false。

+ __string1__ 可从配置列表中随机选取一值。

+ __string2__ 可使用 minL、maxL 配置项规定其长度范围，默认范围 1 ~ 11。

+ __image1__ 可从配置列表中随机选取一值。

+ __image2__ 可使用 type 配置项规定图片尺寸，目前支持：640 * 307 (-w)、320 * 320 (-half)、120 * 120 (-thumb)。

+ __list1__ 可使用 length 配置项规定列表长度，默认长度为 0。

+ __list2__ 可使用 length 配置项规定列表长度，默认长度为 0。

*****

### 关于 List 类型的几点说明

__关于列表项 index__

```js
index: {
    name: 'idx', // 规定命名，默认命名为 'index'
    format: '\d', // 规定格式，默认格式为 '\d'
    type: 'int' // 规定变量类型
}
```

目前支持如下三种格式：

+ '\d' 格式：idx 值为 1, 2, 3, 4, ...（默认变量类型 int）

+ '0\d' 格式：idx 值为 01, 02, 03, ... 10, 11, ...（变量类型仅有 string）

+ '00\d' 格式：idx 值为 001, 002, ... 010, 011, ... 099, 100, 101, ...（变量类型仅有 string）

__注意 data 配置项的写法__

+ data: type.number() 返回列表值相同，list: [val, val, val, ...]

+ data: function () { return type.number() } 返回列表值不同，list: [val1, val2, val3, ...]



